<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgriConnect - Social</title>
    <link rel="stylesheet" href="home.css">
    <link rel="stylesheet" href="social.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="auth.js"></script>
    <script src="social.js" defer></script>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="logo">
            <img src="assets/logo.svg" alt="Logo">
            <span>AgriConnect</span>
        </div>
        <div class="nav-links">
            <a href="home.html" class="active">Home</a>
            <a href="home.html#services">Services</a>
            <a href="home.html#about">About Us</a>
            <a href="message.html"><i class="fas fa-comments"></i> Messages</a>
        </div>
        <div class="auth-buttons">
            <button class="login-btn" id="nav-login-btn" onclick="window.location.href='login.html'">Login</button>
            <!-- Profile Dropdown (Initially hidden by JS, shown when logged in) -->
            <div class="profile-dropdown" id="nav-profile-dropdown">
                <div class="profile-trigger">
                    <img src="assets/default-avatar.svg" alt="Profile" class="profile-image" id="nav-profile-image">
                    <span class="profile-name" id="nav-profile-name">User</span>
                </div>

                <div class="dropdown-content">
                    <a href="profile.html" class="dropdown-item">
                        <i class="fas fa-user"></i>
                        My Profile
                    </a>
                    <a href="message.html" class="dropdown-item" id="notification-button">
                        <i class="fas fa-bell"></i>
                        Notifications <span class="notification-count" style="display:none;">0</span>
                    </a>
                    <a href="#" class="dropdown-item" id="nav-logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                        Logout
                    </a>
                </div>
            </div>
        </div>
        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </nav>

    <br>
    <br>
    <br>
    <br>

    <div class="container">
        <!-- Left Sidebar -->
        <aside class="left-sidebar">
            <div class="user-profile">
                <img id="currentUserImg" src="assets/default-avatar.svg" alt="Profile" class="profile-img">
                <div id="currentUserName" class="user-name">Loading...</div>
                <div id="currentUserBio" class="user-bio">Loading bio...</div>
                <div class="user-stats">
                    <button id="currentUserPosts" class="stat-btn"><span class="stat-number">0</span><span
                            class="stat-label">Posts</span></button>
                    <button id="currentUserFollowers" class="stat-btn"><span class="stat-number">0</span><span
                            class="stat-label">Followers</span></button>
                    <button id="currentUserFollowing" class="stat-btn"><span class="stat-number">0</span><span
                            class="stat-label">Following</span></button>
                </div>
                <button class="profile-btn" onclick="window.location.href='profile.html'">View Profile</button>
            </div>
        </aside>
        <!-- Main Content -->
        <main class="main-content">
            <button id="showAllPostsBtn" class="post-btn" style="margin-bottom: 1rem; display:none;">Show All
                Posts</button>
            <div class="post-form">
                <textarea id="postContent" class="post-input" placeholder="What's on your mind?"></textarea>
                <div class="post-actions">
                    <input type="file" id="postImage" class="file-input" accept="image/*" style="display:none;">
                    <button class="post-btn" id="uploadImageBtn" type="button">Upload Image</button>
                    <span id="imageName" style="margin-left:10px;color:#555;"></span>
                    <img id="imagePreview" src="" alt="Image Preview"
                        style="display:none;max-width:100px;max-height:100px;margin-left:10px;border-radius:10px;" />
                    <button class="post-btn" id="updatePostBtn">Update Post</button>
                </div>
            </div>
            <section id="postFeed" class="post-feed">
                <div class="loading">Loading posts...</div>
            </section>
        </main>
        <!-- Right Sidebar -->
        <aside class="right-sidebar">
            <div class="search-section">
                <select id="userFilterDropdown" class="user-filter-dropdown">
                    <option value="all">All Users</option>
                    <option value="followers">Followers</option>
                    <option value="following">Following</option>
                </select>
                <input type="text" class="search-input" placeholder="Search users..." id="searchInput">
                <button class="notification-btn" id="notificationBtn">
                    <i class="fas fa-bell"></i>
                    <span id="notificationCount" class="notification-count" style="display: none;">0</span>
                </button>
            </div>
            <div id="userList" class="user-list"></div>
        </aside>
    </div>
    <!-- Message Button -->
    <button class="message-btn" onclick="window.location.href='message.html'">ðŸ’¬</button>
    <!-- Notification Modal -->
    <div id="notificationModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeNotifications">&times;</span>
            <h2>Notifications</h2>
            <div id="notificationList">
                <div class="loading">Loading notifications...</div>
            </div>
        </div>
    </div>
    <!-- Post Details Modal -->
    <div id="postModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closePostModal">&times;</span>
            <div id="postModalContent"></div>
        </div>
    </div>
    <!-- Contact Info Modal -->
    <div id="contactInfoModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeContactInfoModal">&times;</span>
            <h2>Contact Info</h2>
            <div id="contactInfoContent"></div>
        </div>
    </div>
</body>

</html>
